"""
Simple i18n helper with built-in translation dictionary.
"""

import os

from common.logger import get_logger

# Logger for i18n helpers
logger = get_logger(__name__)

# Translation table keyed by language code
tr = {
    "en": {
        "title": "üîç Image Search",
        "caption": "üöÄ Similar Image Search application built with vector retrieval feature of OceanBase database",
        "settings": "üîß Settings",
        "search_setting": "Searching Setting",
        "table_name_input": "Table Name",
        "table_name_help": "Name of the table that stores image vectors and other data",
        "recall_number": "Recall Number",
        "recall_number_help": "How many similar images to return",
        "search_mode": "Search Mode",
        "search_mode_help": "Choose how to search: full-text only, hybrid (vector + text), or vector only",
        "search_mode_text": "Full-text",
        "search_mode_hybrid": "Hybrid",
        "search_mode_vector": "Vector",
        "distance_threshold": "Vector Search Distance Threshold",
        "distance_threshold_help": "Only show results with distance <= this value (only effective in vector mode)",
        "show_distance": "Show Distance",
        "show_file_path": "Show File Path",
        "load_setting": "Loading Setting",
        "image_base_input": "Image Base",
        "image_base_help": "Absolute path of directory containing images to load",
        "image_base_placeholder": "Absolute path like /data/imgs",
        "load_images": "Load Images",
        "set_table_name_pls": "Set table name first please",
        "set_image_base_pls": "Set image base first please",
        "image_base_not_exist": "The image base directory you set ({}) does not exist",
        "images_loading": "Loading images...",
        "images_loading_progress": "Loading images... (Finished {} / {})",
        "images_loaded": "All images are loaded successfully!",
        "image_upload_label": "Choose an image to upload...",
        "image_upload_help": "Upload an image to search for similar images",
        "image_search_button": "üîç Search Similar Images",
        "uploaded_image_header": "Upload Image",
        "uploaded_image_caption": "üìå Uploaded Image",
        "similar_images_header": "Similar Images",
        "no_similar_images": "No similar images found",
        "image_no": "Image {}",
        "distance": "üìè Distance:",
        "file_path": "üìÇ File path:",
        "image_caption": "üìù Description:",
        "table_not_exist": "The table {} does not exist, load images first please",
        "upload_image_archive": "Upload Image Archive",
        "image_archive": "Image Archive",
        "image_archive_help": "Select an image archive file and click Load Images to extract and load images",
        "text_search_header": "üîç Text Search",
        "text_search_label": "Enter keywords to search images",
        "text_search_placeholder": "e.g.: cat, dog, sunset, mountain...",
        "search_button": "üîç Search",
        "text_search_query_header": "Search Query",
        "text_search_query_caption": "üìù Your search keywords",
        "search_results_header": "Search Results",
        "search_query": "Search Query",
        "no_search_results": "No matching images found",
        "text_search_empty_warning": "Please enter search keywords",
        "text_score": "üéØ Score:",
    },
    "zh": {
        "title": "üîç ÂõæÂÉèÊêúÁ¥¢Â∫îÁî®",
        "caption": "üöÄ Âü∫‰∫é OceanBase ÂêëÈáèÊ£ÄÁ¥¢ËÉΩÂäõÊûÑÂª∫ÁöÑÁõ∏‰ººÂõæÂÉèÊêúÁ¥¢Â∫îÁî®",
        "settings": "üîß Â∫îÁî®ËÆæÁΩÆ",
        "search_setting": "ÂõæÁâáÊêúÁ¥¢ËÆæÁΩÆ",
        "table_name_input": "Ë°®Âêç",
        "table_name_help": "Áî®‰∫éÂ≠òÊîæÂõæÁâáÁöÑÂêëÈáèÂíåÂÖ∂‰ªñÊï∞ÊçÆÁöÑË°®Âêç",
        "recall_number": "Âè¨ÂõûÊï∞Èáè",
        "recall_number_help": "ÈúÄË¶ÅËøîÂõûÂ§öÂ∞ëÂº†Áõ∏‰ººÁÖßÁâá",
        "search_mode": "ÊêúÁ¥¢Ê®°Âºè",
        "search_mode_help": "ÈÄâÊã©ÊêúÁ¥¢ÊñπÂºèÔºöÁ∫ØÂÖ®Êñá„ÄÅÊ∑∑ÂêàÔºàÂêëÈáè+ÂÖ®ÊñáÔºâÊàñÁ∫ØÂêëÈáè",
        "search_mode_text": "ÂÖ®ÊñáÊ£ÄÁ¥¢",
        "search_mode_hybrid": "Ê∑∑ÂêàÊ£ÄÁ¥¢",
        "search_mode_vector": "ÂêëÈáèÊ£ÄÁ¥¢",
        "distance_threshold": "ÂêëÈáèÊêúÁ¥¢Ë∑ùÁ¶ªÈòàÂÄº",
        "distance_threshold_help": "Âè™ÊòæÁ§∫Ë∑ùÁ¶ªÂ∞è‰∫éÁ≠â‰∫éËØ•ÂÄºÁöÑÁªìÊûúÔºà‰ªÖÂú®ÂêëÈáèÊ£ÄÁ¥¢Ê®°Âºè‰∏ãÁîüÊïàÔºâ",
        "show_distance": "ÊòæÁ§∫Ë∑ùÁ¶ª",
        "show_file_path": "ÊòæÁ§∫Êñá‰ª∂Ë∑ØÂæÑ",
        "load_setting": "ÂõæÁâáÂä†ËΩΩËÆæÁΩÆ",
        "image_base_input": "ÂõæÁâáÂä†ËΩΩÁõÆÂΩï",
        "image_base_help": "ÈúÄË¶ÅÂä†ËΩΩÁöÑÂõæÁâáÁõÆÂΩïË∑ØÂæÑ",
        "image_base_placeholder": "ÂõæÁâáÁõÆÂΩïÁöÑÁªùÂØπË∑ØÂæÑÔºåÂ¶Ç /data/imgs",
        "load_images": "Âä†ËΩΩÂõæÁâá",
        "set_table_name_pls": "ËØ∑ËÆæÁΩÆË°®Âêç",
        "set_image_base_pls": "ËØ∑ËÆæÁΩÆÂõæÁâáÂä†ËΩΩÁõÆÂΩï",
        "image_base_not_exist": "ÊÇ®ËÆæÁΩÆÁöÑÂõæÁâáÂä†ËΩΩÁõÆÂΩï {} ‰∏çÂ≠òÂú®",
        "images_loading": "ÂõæÁâáÂä†ËΩΩ‰∏≠...",
        "images_loading_progress": "ÂõæÁâáÂä†ËΩΩ‰∏≠... (Â∑≤ÂÆåÊàê {} / {})",
        "images_loaded": "ÊâÄÊúâÂõæÁâáÂä†ËΩΩÂÆåÊàêÔºÅ",
        "image_upload_label": "ÈÄâÊã©‰∏ÄÂº†ÂõæÁâá...",
        "image_upload_help": "‰∏ä‰º†‰∏ÄÂº†ÂõæÁâá‰ª•ÊêúÁ¥¢Áõ∏‰ººÂõæÁâá",
        "image_search_button": "üîç ÊêúÁ¥¢Áõ∏‰ººÂõæÁâá",
        "uploaded_image_header": "‰∏ä‰º†ÂõæÁâá",
        "uploaded_image_caption": "üìå ÊÇ®‰∏ä‰º†ÁöÑÂõæÁâá",
        "similar_images_header": "Áõ∏‰ººÂõæÁâá",
        "no_similar_images": "Ê≤°ÊúâÊâæÂà∞Áõ∏‰ººÂõæÁâá",
        "image_no": "ÂõæÁâá {}",
        "distance": "üìè Ë∑ùÁ¶ª:",
        "file_path": "üìÇ Êñá‰ª∂Ë∑ØÂæÑ:",
        "image_caption": "üìù ÊèèËø∞:",
        "table_not_exist": "ÂõæÁâáË°® {} ‰∏çÂ≠òÂú®ÔºåËØ∑ÂÖàÂä†ËΩΩÂõæÁâá",
        "upload_image_archive": "‰∏ä‰º†ÂõæÁâáÂéãÁº©ÂåÖ",
        "image_archive": "ÂõæÁâáÂéãÁº©ÂåÖ",
        "image_archive_help": "ÈÄâ‰∏≠‰∏Ä‰∏™Â∑≤‰∏ä‰º†ÁöÑÂõæÁâáÂéãÁº©ÂåÖÔºåÁÇπÂáªÂä†ËΩΩÂõæÁâáÊù•ÊâπÈáèÂä†ËΩΩÂõæÁâá",
        "text_search_header": "üîç ÊñáÊú¨ÊêúÁ¥¢",
        "text_search_label": "ËæìÂÖ•ÂÖ≥ÈîÆËØçÊêúÁ¥¢ÂõæÁâá",
        "text_search_placeholder": "‰æãÂ¶ÇÔºöcat, dog, sunset, mountain...",
        "search_button": "üîç ÊêúÁ¥¢",
        "text_search_query_header": "ÊêúÁ¥¢ÂÖ≥ÈîÆËØç",
        "text_search_query_caption": "üìù ÊÇ®ÁöÑÊêúÁ¥¢ÂÖ≥ÈîÆËØç",
        "search_results_header": "ÊêúÁ¥¢ÁªìÊûú",
        "search_query": "ÊêúÁ¥¢ÂÖ≥ÈîÆËØç",
        "no_search_results": "Êú™ÊâæÂà∞ÂåπÈÖçÁöÑÂõæÁâá",
        "text_search_empty_warning": "ËØ∑ËæìÂÖ•ÊêúÁ¥¢ÂÖ≥ÈîÆËØç",
        "text_score": "üéØ ÂåπÈÖçÂàÜÊï∞:",
    },
    "ja": {
        "title": "üîç ÁîªÂÉèÊ§úÁ¥¢„Ç¢„Éó„É™",
        "caption": "üöÄ OceanBase „ÅÆ„Éô„ÇØ„Éà„É´Ê§úÁ¥¢Ê©üËÉΩ„ÅßÊßãÁØâ„Åï„Çå„ÅüÈ°û‰ººÁîªÂÉèÊ§úÁ¥¢„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥",
        "settings": "üîß Ë®≠ÂÆö",
        "search_setting": "Ê§úÁ¥¢Ë®≠ÂÆö",
        "table_name_input": "„ÉÜ„Éº„Éñ„É´Âêç",
        "table_name_help": "ÁîªÂÉè„Éô„ÇØ„Éà„É´„Å™„Å©„Çí‰øùÂ≠ò„Åô„Çã„ÉÜ„Éº„Éñ„É´Âêç",
        "recall_number": "„É™„Ç≥„Éº„É´Êï∞",
        "recall_number_help": "„É™„Ç≥„Éº„É´ÔºàÊ§úÁ¥¢Ôºâ„Åô„ÇãÈ°û‰ººÁîªÂÉè„ÅÆÊûöÊï∞„ÇíÊåáÂÆö„Åó„Å¶„Åè„Å†„Åï„ÅÑ",
        "search_mode": "Ê§úÁ¥¢„É¢„Éº„Éâ",
        "search_mode_help": "Ê§úÁ¥¢ÊñπÊ≥ï„ÇíÈÅ∏ÊäûÔºöÂÖ®ÊñáÊ§úÁ¥¢„ÅÆ„Åø„ÄÅ„Éè„Ç§„Éñ„É™„ÉÉ„ÉâÔºà„Éô„ÇØ„Éà„É´ÔºãÂÖ®ÊñáÔºâ„ÄÅ„Éô„ÇØ„Éà„É´„ÅÆ„Åø",
        "search_mode_text": "ÂÖ®ÊñáÊ§úÁ¥¢",
        "search_mode_hybrid": "„Éè„Ç§„Éñ„É™„ÉÉ„Éâ",
        "search_mode_vector": "„Éô„ÇØ„Éà„É´Ê§úÁ¥¢",
        "distance_threshold": "„Éô„ÇØ„Éà„É´Ê§úÁ¥¢Ë∑ùÈõ¢„Åó„Åç„ÅÑÂÄ§",
        "distance_threshold_help": "Ë∑ùÈõ¢„Åå„Åì„ÅÆÂÄ§‰ª•‰∏ã„ÅÆÁµêÊûú„ÅÆ„ÅøË°®Á§∫„Åó„Åæ„ÅôÔºà„Éô„ÇØ„Éà„É´Ê§úÁ¥¢„É¢„Éº„Éâ„Åß„ÅÆ„ÅøÊúâÂäπÔºâ",
        "show_distance": "Ë∑ùÈõ¢„ÇíË°®Á§∫„Åô„Çã",
        "show_file_path": "„Éï„Ç°„Ç§„É´„Éë„Çπ„ÇíË°®Á§∫„Åô„Çã",
        "load_setting": "Ë™≠„ÅøËæº„ÅøË®≠ÂÆö",
        "image_base_input": "ÁîªÂÉè„Éá„Ç£„É¨„ÇØ„Éà„É™",
        "image_base_help": "Ë™≠„ÅøËæº„ÇÄÁîªÂÉè„Éá„Ç£„É¨„ÇØ„Éà„É™„ÅÆ„Éë„Çπ„ÇíÊåáÂÆö„Åó„Å¶„Åè„Å†„Åï„ÅÑ",
        "image_base_placeholder": "ÁîªÂÉè„Éá„Ç£„É¨„ÇØ„Éà„É™„ÅÆÁµ∂ÂØæ„Éë„ÇπÔºà‰æã: /data/imgsÔºâ",
        "load_images": "ÁîªÂÉè„ÇíË™≠„ÅøËæº„ÇÄ",
        "set_table_name_pls": "ÂÖà„Å´„ÉÜ„Éº„Éñ„É´Âêç„ÇíË®≠ÂÆö„Åó„Å¶„Åè„Å†„Åï„ÅÑ",
        "set_image_base_pls": "ÂÖà„Å´ÁîªÂÉè„Éá„Ç£„É¨„ÇØ„Éà„É™„ÇíË®≠ÂÆö„Åó„Å¶„Åè„Å†„Åï„ÅÑ",
        "image_base_not_exist": "Ë®≠ÂÆö„Åï„Çå„ÅüÁîªÂÉè„Éá„Ç£„É¨„ÇØ„Éà„É™ {} „ÅåÂ≠òÂú®„Åó„Åæ„Åõ„Çì",
        "images_loading": "ÁîªÂÉè„ÇíË™≠„ÅøËæº„Çì„Åß„ÅÑ„Åæ„Åô...",
        "images_loading_progress": "ÁîªÂÉè„ÇíË™≠„ÅøËæº„Çì„Åß„ÅÑ„Åæ„Åô... (ÂÆå‰∫Ü {} / {})",
        "images_loaded": "„Åô„Åπ„Å¶„ÅÆÁîªÂÉè„ÅåÊ≠£Â∏∏„Å´Ë™≠„ÅøËæº„Åæ„Çå„Åæ„Åó„ÅüÔºÅ",
        "image_upload_label": "ÁîªÂÉè„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ...",
        "image_upload_help": "È°û‰ººÁîªÂÉè„ÇíÊ§úÁ¥¢„Åô„Çã„Åü„ÇÅ„ÅÆÁîªÂÉè„Çí„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ„Åó„Åæ„Åô",
        "image_search_button": "üîç È°û‰ººÁîªÂÉè„ÇíÊ§úÁ¥¢",
        "uploaded_image_header": "„Ç¢„ÉÉ„Éó„É≠„Éº„ÉâÁîªÂÉè",
        "uploaded_image_caption": "üìå „Ç¢„ÉÉ„Éó„É≠„Éº„Éâ„Åï„Çå„ÅüÁîªÂÉè",
        "similar_images_header": "È°û‰ººÁîªÂÉè",
        "no_similar_images": "È°û‰ººÁîªÂÉè„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü",
        "image_no": "ÁîªÂÉè {}",
        "distance": "üìè Ë∑ùÈõ¢:",
        "file_path": "üìÇ „Éï„Ç°„Ç§„É´„Éë„Çπ:",
        "image_caption": "üìù Ë™¨Êòé:",
        "table_not_exist": "ÁîªÂÉè„ÉÜ„Éº„Éñ„É´ {} „ÅåÂ≠òÂú®„Åó„Åæ„Åõ„Çì„ÄÇÂÖà„Å´ÁîªÂÉè„ÇíË™≠„ÅøËæº„Çì„Åß„Åè„Å†„Åï„ÅÑ",
        "upload_image_archive": "ÁîªÂÉèÁî®ÂúßÁ∏Æ„Éï„Ç°„Ç§„É´„ÅÆ„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ",
        "image_archive": "ÁîªÂÉèÁî®ÂúßÁ∏Æ„Éï„Ç°„Ç§„É´",
        "image_archive_help": "„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ„Åï„Çå„ÅüÂúßÁ∏Æ„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû„Åó„ÄÅ„ÄåÁîªÂÉè„ÇíË™≠„ÅøËæº„ÇÄ„Äç„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶‰∏ÄÊã¨Âá¶ÁêÜ„Åó„Åæ„Åô",
        "text_search_header": "üîç „ÉÜ„Ç≠„Çπ„ÉàÊ§úÁ¥¢",
        "text_search_label": "„Ç≠„Éº„ÉØ„Éº„Éâ„ÇíÂÖ•Âäõ„Åó„Å¶ÁîªÂÉè„ÇíÊ§úÁ¥¢",
        "text_search_placeholder": "‰æãÔºöcat, dog, sunset, mountain...",
        "search_button": "üîç Ê§úÁ¥¢",
        "text_search_query_header": "Ê§úÁ¥¢„ÇØ„Ç®„É™",
        "text_search_query_caption": "üìù Ê§úÁ¥¢„Ç≠„Éº„ÉØ„Éº„Éâ",
        "search_results_header": "Ê§úÁ¥¢ÁµêÊûú",
        "search_query": "Ê§úÁ¥¢„ÇØ„Ç®„É™",
        "no_search_results": "‰∏ÄËá¥„Åô„ÇãÁîªÂÉè„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü",
        "text_search_empty_warning": "Ê§úÁ¥¢„Ç≠„Éº„ÉØ„Éº„Éâ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ",
        "text_score": "üéØ „Çπ„Ç≥„Ç¢:",
    },
}

# Read UI language from env and fallback to zh
lang = os.getenv("UI_LANG", "zh")
if lang not in ["en", "zh", "ja"]:
    logger.warning("Invalid language %s, using default (zh).", lang)
    lang = "zh"


def t(key: str, *args) -> str:
    """
    Translate a key with optional format arguments.
    """
    if len(args) > 0:
        return tr[lang].get(key, "TODO: " + key).format(*args)
    return tr[lang].get(key, "TODO: " + key)
